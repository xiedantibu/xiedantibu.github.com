---
layout: post
title: "创建和编译着色器"
category : cocos2d-x
tagline: "..."
tags : [opengles,cocos2d-x]
---
 本文为[xiedantibu](http://blog.xulingmin.com/)在学习opengles的笔记
，转载请注明作者及出处！ 
###目录
 ----
 <a id='top' name='top'></a>
 &nbsp;&nbsp;&nbsp;&nbsp;[**创建着色器**](#create)    
 &nbsp;&nbsp;&nbsp;&nbsp;[**加载着色器源码**](#loadsource)  
 &nbsp;&nbsp;&nbsp;&nbsp;[**编译着色器**](#CompileShader)   
 &nbsp;&nbsp;&nbsp;&nbsp;[**获取编译状态**](#COMPILESTATUS)   
 &nbsp;&nbsp;&nbsp;&nbsp;[**调用info日志**](#info)   
 &nbsp;&nbsp;&nbsp;&nbsp;[**获取着色器源码**](#getsource) 
 
 
 --- 
<a id='create' name='create'> </a>
####[创建着色器](#top)
---
`GLuint glCreateShader(GLenum type)`  

	type:着色器的类型 GL_VERTEX_SHADER或者GL_FRAGMENT_SHADER.
	使用glCreateShader你能依据输入参数创建一个顶点着色器或片段着色器,返回值是个新着色器的句柄,不使用了,用 glDeleteShader删除它。

`void glDeleteShader(GLuint shader)`

	shader:要删除的着色器句柄.
	如果着色器正连接着一个项目对象,glDeleteShader不会立刻删除着色器,而是设置删除标记,一旦着色器不再连接项目对象,才删除着色器使用的内存。

 --- 
<a id='loadsource' name='loadsource'> </a>
####[加载着色器源码](#top)
---

`void glShaderSource(GLuint shader, GLsizei count,const char** string,const GLint* length)`

	shader :着色器对象句柄
	count  :着色器源码的字符数,着色器由字符串组成,每个着色器仅有一个主函数main
	string :指向着色器源码字符串矩阵的指针
	length :pointer to an array of count integers that holds the size of each respective shader string. If length is NULL, the shader strings are assumed to be null terminated. If length is not NULL, then each element of length holds the number of characters in the corresponding shader in the string array. If the value of length for any element is less than zero, then that string is assumed to be null terminated

 --- 
<a id='CompileShader' name='CompileShader'> </a>
####[编译着色器](#top)
---

`void glCompileShader(GLuint shader)`

	shader :着色器对象句柄

 --- 
<a id='COMPILESTATUS' name='COMPILESTATUS'> </a>
####[获取编译状态](#top)
---

`void glGetShaderiv(GLuint shader, GLenum pname,GLint *params)`

	shader :着色器句柄
	pname  :需要查询的信息.GL_COMPILE_STATUS|GL_DELETE_STATUS|GL_INFO_LOG_LENGTH|GL_SHADER_SOURCE_LENGTH|GL_SHADER_TYPE
	Params :返回查询结果的整型指针

**使用`GL_COMPILE_STATUS`参数查询编译是否成功,成功返回`GL_TRUE`,失败返回`GL_FALSE`。如失败,编译错误被写入 info日志。info日志记录了编译器的任何错误和警告。 即使编译成功,同样也有info日志,可以使用`GL_INFO_LOG_LENGTH`查询 info日志长度。 可以调用`glGetShaderInfoLog`调用info日志。使用`GL_SHADER_TYPE`查询着色器类型是`GL_VERTEX_SHADER`或者`GL_FRAGMENT_SHADER`.使用`GL_SHADER_SOURCE_LENGTH`查询着色器源码长度,即使着色器为空。使用`GL_DELETE_STATUS`查询着色器是否被`glDeleteShader`标记删除。**

 --- 
<a id='info' name='info'> </a>
####[调用info日志](#top)
---

`void glGetShaderInfoLog(GLuint shader, GLsizei maxLength, GLsizei *length, GLchar *infoLog)`

	shader :handle to the shader object to get the info log for
	maxLength :the size of the buffer to store the info log in
	length :the length of the info log written (minus the null terminator). If the length does not need to be known, this parameter can be NULL
	infoLog :pointer to the character buffer to store the info log in

**要使用`glGetShaderInfoLog`调用info日志,首先要通过`glGetShaderiv`查询`GL_INFO_LOG_LENGTH`,因为只有分配足够的字符串才能存储info log。**

 --- 
<a id='getsource' name='getsource'> </a>
####[获取着色器源码](#top)
---
`void glGetShaderSource(GLuint shader, GLsizei bufsize, GLsizei *length, GLchar *source)`

	shader :指定查询的着色器
	bufsize :the number of bytes available in the array source for returning the shader’s source
    length :the length of the returned shader string
    source :指定存储着着色器源码的GLchar类型数组