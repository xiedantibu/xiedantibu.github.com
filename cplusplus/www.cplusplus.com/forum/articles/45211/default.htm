<!DOCTYPE html><!-- saved from url=(0057)http://www.cplusplus.com/forum/articles/45211/default.htm --><meta http-equiv="X-UA-Compatible" content="IE=Edge" />

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Using noexcept - C++ Forum</title>
<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico">
<link rel="stylesheet" type="text/css" href="../../../v321/main.css">
<script src="../../../v321/main.js" type="text/javascript"></script>
</head>
<body>
<div id="I_top">
<div id="I_header">
<div id="I_logo"><a href="../../../default.htm" title="cplusplus.com"><div></div></a></div>
<div id="I_search">
<form id="search" action="/search.do" method="get">
Search: <input name="q" size="20" class="txt"> <input type="submit" value="Go" class="btn">
</form>
</div>
<div id="I_bar">
<ul>
<li><a href="../../default.htm">Forum</a></li>
<li><a href="../default.htm">Articles</a></li>
<li class="here">Using noexcept</li>
</ul>
</div>
<div id="I_user" class="C_LoginBox"><span title="ajax"></span></div>
</div>
</div>
<div id="I_mid">
<div id="I_wrap">
<div id="I_minheight"></div>
<div id="I_main">
<div class="C_support"><script type="text/javascript"><!--
if (!cookieGet("hspt31")) {
  document.write('<div class="C_DonateBox"></div>');
}
//-->
</script><div class="C_ad728"><script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7973859818";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<acript type="text/javascript"
src="../../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div><div class="C_supportbottom"></div></div><div id="I_content">
<h3><div class="C_ico default" title="post">&nbsp;</div> Using noexcept</h3><span id="CH_edttl"></span><span class="rootdatPost" title="45211,root,0,-1,7,0"></span><div id="CH_PostList"><div class="C_forPost" id="msg245369"><span title="245369,60439,1023,5,1"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg245369" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTm314078dd51" title="Tue, 21 Jun 2011 07:48:51 +0000"></span><script type="text/javascript">WhenId('CH_zTm314078dd51');</script><noscript>Jun 21, 2011 at 7:48am UTC</noscript></div>
<div class="dwho"><a href="../../../user/akrzemi1/default.htm"><b>akrzemi1</b> (5)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i245369">
Hi, <br>
Did you notice the new keyword in incoming C++11 standard (C++0x): <i>noexcept</i>? In case you wonder what it does, why it works the way it does, and how you should use it, I wrote an article about it on my blog. Here is the link:<br>
<a href="../../../../akrzemi1.wordpress.com/2011/06/10/using-noexcept/default.htm">http://akrzemi1.wordpress.com/2011/06/10/using-noexcept/</a><br>
<br>
Regards,<br>
&amp;rzej
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn245369"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg245459"><span title="245459,45401,1023,1008,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg245459" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTmdeaa4d3e7a" title="Tue, 21 Jun 2011 16:49:22 +0000"></span><script type="text/javascript">WhenId('CH_zTmdeaa4d3e7a');</script><noscript>Jun 21, 2011 at 4:49pm UTC</noscript></div>
<div class="dwho"><a href="../../../user/rapidcoder/default.htm"><b>rapidcoder</b> (1008)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i245459">
OMG! C++ now doing the same mistake Java did long, long time ago: checked exceptions, only this one is more complex than in any other language. The whole idea that the compiler statically checks what throws exceptions and what not is broken - you can't do it right, and if you try, you get something complex, hard to understand and inconvenient to use. 
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn245459"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg245488"><span title="245488,15588,0,2731,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg245488" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTmfd03c7dca8" title="Tue, 21 Jun 2011 19:03:03 +0000"></span><script type="text/javascript">WhenId('CH_zTmfd03c7dca8');</script><noscript>Jun 21, 2011 at 7:03pm UTC</noscript></div>
<div class="dwho">closed account (<i><a href="../../../user/closed_account_s6k9gnh0/default.htm">S6k9GNh0</a></i>)</div>
</div>
<div class="dwhat" colspan="2" id="CH_i245488">
"You can't do it right". What do you base that on? Just the example from Java?
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn245488"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg245518"><span title="245518,60439,1023,5,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg245518" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTm2c22907369" title="Tue, 21 Jun 2011 20:48:41 +0000"></span><script type="text/javascript">WhenId('CH_zTm2c22907369');</script><noscript>Jun 21, 2011 at 8:48pm UTC</noscript></div>
<div class="dwho"><a href="../../../user/akrzemi1/default.htm"><b>akrzemi1</b> (5)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i245518">
Hi rapidcoder, I believe the situation is not as dark as you describe. The domain of computer technology is young and so is the experience with programming languages. Over the past decade we have seen two unsuccessful approaches to the problem of "exception specifications": one was static exception checking implemented in Java, the other was dynamic exception checking in C++ (C++03). It is good that the two languages took two different approach because we can now see the consequences of both. It appears that the new attempt (with noexcept) tries to learn from the past failures:<br>
1. It is not statically checking for exceptions. On the contrary, it is closer to dynamic specifications. In this sense the the ISO Committee shares your view: do not statically check exceptions.<br>
2. It is not really checking exceptions as the previous approaches did. It only asks one question: is it possible that this function will throw anything or not? In my view, it is simpler than listing all possible exceptions that your function might throw.<br>
<br>
I do not know what it is that you find "more complex" in noexcept solution. Is the keyword itself that is difficult to spell? If you are aware of exception safety guarantees as described here:<br>
<a href="../../../../www.boost.org/community/exception_safety.html">http://www.boost.org/community/exception_safety.html</a><br>
<a href="../../../../www2.research.att.com/~bs/except.pdf">http://www2.research.att.com/~bs/except.pdf</a><br>
<a href="../../../../www2.research.att.com/~bs/3rd_safe.pdf">http://www2.research.att.com/~bs/3rd_safe.pdf</a><br>
you will immediately appreciate the noexcept functionality. If you are not, you will not need to use it and the functionality will definitely not harm you. <br>
<br>
Regards,<br>
&amp;rzej<br>
<br>

</div>
<div class="dhow">
<span class="dbtn" id="CH_btn245518"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg245669"><span title="245669,45401,1023,1008,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg245669" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTmfc5e04fa41" title="Wed, 22 Jun 2011 08:08:21 +0000"></span><script type="text/javascript">WhenId('CH_zTmfc5e04fa41');</script><noscript>Jun 22, 2011 at 8:08am UTC</noscript></div>
<div class="dwho"><a href="../../../user/rapidcoder/default.htm"><b>rapidcoder</b> (1008)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i245669">
The complexity is not about using the noexcept keyword. The complexity is about understanding what it really does, and why it is needed. And as far as I know from reading the discussion list, it is needed mostly for optimisation purposes (avoiding copying and using the new moving constructor feature) - you tell the compiler / library something won't throw, and it tries to use this assumption to make the code faster, without violating exception-safety. Anyway, this feature is probably a new source of incompatibilities between the compilers. For example, will this compile?<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br></code></pre></td>
<td class="source"><pre><code><var>noexcept</var> <var>void</var> buggyFunction() {
  <var>throw</var> Exception();
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
If it compiles (as it does now on GCC), how is that better than old empty throws() declaration?<br>
<br>
<table class="quote"><tr><td class="qd"><br>
"You can't do it right". What do you base that on? Just the example from Java? </td></tr></table><br>
<br>
No, from every other language than C++ and Java. Every other language with exceptions took a way of unchecked exceptions. And there is really no problem with that. Unchecked exceptions are perfectly ok, as long as you use them for the purpose exceptions has been created for - for exceptional, rare cases.
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm01a93cc4f2" title="Wed, 22 Jun 2011 08:12:50 +0000"></span><script type="text/javascript">WhenId('CH_zTm01a93cc4f2');</script><noscript>Jun 22, 2011 at 8:12am UTC</noscript></span>
<span class="dbtn" id="CH_btn245669"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg246326"><span title="246326,60439,1023,5,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg246326" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTmb63c20ad57" title="Fri, 24 Jun 2011 07:08:32 +0000"></span><script type="text/javascript">WhenId('CH_zTmb63c20ad57');</script><noscript>Jun 24, 2011 at 7:08am UTC</noscript></div>
<div class="dwho"><a href="../../../user/akrzemi1/default.htm"><b>akrzemi1</b> (5)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i246326">
<table class="quote"><tr><td class="qd">If it compiles (as it does now on GCC), how is that better than old empty throws() declaration?</td></tr></table><br>
<br>
The new, arguably improved, way of exception specifications also made the good old "throw()" work better: compiler can apply move-vs-swap optimizations also on throw(). The important difference is that noexcept allow to <i>conditionally</i> mark your function as non-throwing. Old C++ (C++03) had a problem that you couldn't correctly specify exception specifications for template functions because you didn't know if (and what) the type T was throwing. Consider this function template:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br></code></pre></td>
<td class="source"><pre><code><var>template</var>&lt; <var>typename</var> T &gt;
T abs( T <var>const</var>&amp; x, T <var>const</var>&amp; y ) {
    <var>return</var> (x*x) + (y*y);
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
Does it throw or not? It depends if T operations (addition, multiplication, copy construction) throw. With noexcept you can say:<br>
<br>
<div class="auto"><table class="snippet"><tr><td class="rownum"><pre><code>1<br>2<br>3<br>4<br>5<br>6<br></code></pre></td>
<td class="source"><pre><code><var>template</var>&lt; <var>typename</var> T &gt;
T abs( T <var>const</var>&amp; x, T <var>const</var>&amp; y ) 
<var>noexcept</var>( <var>noexcept</var>(T((x*x) + (y*y))) )
{
    <var>return</var> (x*x) + (y*y);
}</code></pre></td><td class="C_btnholder"></td></tr></table></div>
<br>
<br>
You may argue that this syntax is silly, but it has one good point about it: it works. This was never possible in C++ before.<br>
<br>
<table class="quote"><tr><td class="qd">No, from every other language than C++ and Java. Every other language with exceptions took a way of unchecked exceptions. And there is really no problem with that. Unchecked exceptions are perfectly ok, as long as you use them for the purpose exceptions has been created for - for exceptional, rare cases. </td></tr></table><br>
<br>
You are probably right that there may not exist anything better than unchecked exceptions, however a couple of things needs to be noted.<br>
<br>
1. The fact that no-one yet knows how to implement compile-time checked static exceptions that work doesn't mean that it is impossible, and I guess it is worth trying. This is how programming languages evolve and get better.<br>
2. I think anyone would agree that compile-time-checked exceptions are useful <b>if</b> we found a way to eliminate problems they cause. So again, it is worth the effort to look for the solution. <br>
<br>
C++ is known for experimenting. This experimenting sometimes revolutionizes computer programming (this is the case of STL, or intorducing throw-try-catch syntax for exception handling into the mainstream) and sometimes ends in failure (like exported templates, dynamic exception specifications) but in the end it look like the best approach to make progress in the long run. <br>
<br>
Regards,<br>
&amp;rzej
</div>
<div class="dhow">
<span class="dbtn" id="CH_btn246326"></span>

</div>
</div>
</div>
<div class="C_forPost" id="msg246370"><span title="246370,45401,1023,1008,0"></span>
<div class="box">
<div class="boxtop">
<div class="dwhen"><a href="#msg246370" title="Link to this post"><img src="../../../img/link.png" width="16" height="8"></a> <span id="CH_zTm20438fd896" title="Fri, 24 Jun 2011 10:11:08 +0000"></span><script type="text/javascript">WhenId('CH_zTm20438fd896');</script><noscript>Jun 24, 2011 at 10:11am UTC</noscript></div>
<div class="dwho"><a href="../../../user/rapidcoder/default.htm"><b>rapidcoder</b> (1008)</a></div>
</div>
<div class="dwhat" colspan="2" id="CH_i246370">
Thanks for explanation. The conditional noexcept is a nice thing, albeit I don't like the additional syntactical complexity it requires.
</div>
<div class="dhow">
<span class="sedited">Last edited on <span id="CH_zTm320ff314fe" title="Fri, 24 Jun 2011 10:13:00 +0000"></span><script type="text/javascript">WhenId('CH_zTm320ff314fe');</script><noscript>Jun 24, 2011 at 10:13am UTC</noscript></span>
<span class="dbtn" id="CH_btn246370"></span>

</div>
</div>
</div>
</div><div class="rootinsMore"></div><div class="rootbtnMore"></div><div class="rootinsNew"></div><div class="rootbtnNew"></div><div id="CH_insNew"></div><div id="CH_reply">Topic archived. No new replies allowed.</div><div id="CH_subscription"></div><div class="rootedtNew"></div><script type="text/javascript">new for_PostList(45211,1,60439,0,'CH_PostList','CH_subscription','CH_reply','CH_insNew','CH_edttl','../../thread.cgi','../../post.cgi','../../myposts.cgi.htm',64,32,512,256,1024,16);</script></div>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7973859818";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<acript type="text/javascript"
src="../../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="I_nav">
<div class="sect root">
<h3><b><a href="../../../default.htm">C++</a></b></h3>
<ul>
<li class="folder info"><a href="../../../info/default.htm">Information</a></li>
<li class="folder doc"><a href="../../../doc/default.htm">Tutorials</a></li>
<li class="folder reference"><a href="../../../reference/default.htm">Reference</a></li>
<li class="folder articles"><a href="../../../articles/default.htm">Articles</a></li>
<li class="folder selected forum"><a href="../../default.htm">Forum</a></li>
</ul>
</div>
<div class="sect">
<h3><b><a href="../../default.htm">Forum</a></b></h3>
<ul>
<li><a href="../../beginner/default.htm"><b>Beginners</b></a></li><li><a href="../../windows/default.htm"><b>Windows Programming</b></a></li><li><a href="../../unices/default.htm"><b>UNIX/Linux Programming</b></a></li><li><a href="../../general/default.htm"><b>General C++ Programming</b></a></li><li><a href="../../lounge/default.htm"><b>Lounge</b></a></li><li><a href="../../jobs/default.htm"><b>Jobs</b></a></li></ul>
</div>
<div id="I_subnav"></div>
<div class="C_ad234">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-7688470879129516";
google_ad_slot = "7445514729";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<acript type="text/javascript"
src="../../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<div id="I_midclear"></div>
</div>
</div>
<div id="I_bottom">
<div id="I_footer">
	<a href="../../../default.htm">Home page</a> | <a href="../../../privacy.do.htm">Privacy policy</a><br>&copy; cplusplus.com, 2000-2014 - All rights reserved - <i>v3.1</i><br><a href="../../../contact.doreferrerwww.cplusplus~584.com_">Spotted an error? contact us</a>
</div>
</div>

<script type="text/javascript">
<!--
function NavFor(us) {document.getElementById('I_subnav').innerHTML=us.ok?'<div class="sect"><h3><b><a href="../../../user/default.htm">'+us.user+'</a></b></h3><ul><li><a href="../../myposts.cgi.htm">My topics</a></li></ul></div>':'';}onSession(NavFor);ready();
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-521783-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? '../../../../httpsssl/default.htm' : '../../../../www/default.htm') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//-->
</script>

</body>
</html>